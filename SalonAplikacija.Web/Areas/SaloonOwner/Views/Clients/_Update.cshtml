@model ClientUpdateVM

@inject IAjaxFlashMessage AjaxFlashMessage

<div class="modal fade" id="update-client" tabindex="-1" role="dialog" aria-labelledby="updateClientLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
                <form action="Update">
                    @*<div asp-validation-summary="ModelOnly" class="text-danger"></div>*@
                    @AjaxFlashMessage.Display()
                    <input asp-for="ClientId" type="hidden" />

                    <input name="IsValid" type="hidden" value="@ViewData.ModelState.IsValid.ToString()" />
                    <div class="form-group">
                        @Html.DropDownListFor(x => x.ClientTypeId, Model.ClientTypes as SelectList, "Select a type", new { @class = "form-control" })
                        <span asp-validation-for="ClientTypeId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        @Html.DropDownListFor(x => x.CountryId, Model.Countries as SelectList, "Select a country", new { @class = "form-control" })
                        <span asp-validation-for="CountryId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        @Html.DropDownListFor(x => x.CityId, new SelectList(""), "Select a city", new { @class = "form-control" })
                        <span asp-validation-for="CityId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <input asp-for="FirstName" class="form-control" />
                        <span asp-validation-for="FirstName" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <input asp-for="LastName" class="form-control" />
                        <span asp-validation-for="LastName" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <input asp-for="Email" class="form-control" />
                    </div>
                    <div class="form-group">
                        <input asp-for="Address" class="form-control" />
                    </div>
                    <div class="form-group">
                        <input asp-for="Phone" class="form-control" />
                        <span asp-validation-for="Phone" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-sm btn-primary" id="btnUpdateClient" data-save="modal">Save</button>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script>
    //Country-city cascade dropdown logic


    $(document).ready(function () {

        $.get("/SaloonOwner/Clients/GetCity", { CityId: @Model.CityId },
            function (data) {
                $("#CityId option:selected").remove();
                $("#CityId").append("<option value='" + data.cityId + "'>" + data.name + "</option>");
         });

        $("#CountryId").change(function () {
            $.get("/SaloonOwner/Clients/GetCities",
                { CountryId: $(this).val() },
                function (data) {
                    $("#CityId").empty();
                    $.each(data, function (key, value) {
                        $("#CityId").append("<option value='" + value.cityId + "'>" + value.name + "</option>");

                    });
                });
        });

        //$("[data-save='modal']").click(function () {
        //    var form = $(this).parents('.modal').find('form');
        //    var actionUrl = form.attr('action');
        //    var dataToSend = form.serialize();

        //    $.post(actionUrl, dataToSend).done(function (data) {
        //        var newBody = $('.modal-body', data);
        //        placeholderElement.find('.modal-body').replaceWith(newBody);

        //    });
        //});
    
    });

</script>
